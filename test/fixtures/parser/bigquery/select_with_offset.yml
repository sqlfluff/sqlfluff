file:
  statement:
    select_statement:
      select_clause:
        keyword: SELECT
        select_clause_element:
          function:
            function_name: SUM
            start_bracket: (
            expression:
              case_expression:
              - keyword: CASE
              - keyword: WHEN
              - expression:
                - column_reference:
                    identifier: value
                - comparison_operator: '!='
                - column_reference:
                    identifier: previous_value
              - keyword: THEN
              - expression:
                  literal: '1.0'
              - keyword: ELSE
              - expression:
                  literal: '0.0'
              - keyword: END
            end_bracket: )
      from_clause:
        keyword: FROM
        from_expression:
          from_expression_element:
            table_expression:
              start_bracket: (
              select_statement:
                select_clause:
                - keyword: SELECT
                - select_clause_element:
                    column_reference:
                      identifier: value
                - comma: ','
                - select_clause_element:
                    expression:
                      case_expression:
                      - keyword: CASE
                      - keyword: WHEN
                      - expression:
                          column_reference:
                            identifier: ix
                          comparison_operator: '!='
                          literal: '0'
                      - keyword: THEN
                      - expression:
                          function:
                            function_name: LAG
                            start_bracket: (
                            expression:
                              column_reference:
                                identifier: value
                            end_bracket: )
                            over_clause:
                              keyword: OVER
                              start_bracket: (
                              window_specification:
                                orderby_clause:
                                - keyword: ORDER
                                - keyword: BY
                                - column_reference:
                                    identifier: ix
                                - keyword: ASC
                              end_bracket: )
                      - keyword: ELSE
                      - expression:
                          column_reference:
                            identifier: value
                      - keyword: END
                    alias_expression:
                      keyword: AS
                      identifier: previous_value
                from_clause:
                  keyword: FROM
                  from_expression:
                    from_expression_element:
                    - table_expression:
                        function:
                          function_name: UNNEST
                          start_bracket: (
                          expression:
                            column_reference:
                            - identifier: sequence_validation_and_business_rules
                            - dot: .
                            - identifier: sequence_validation_and_business_rules
                          end_bracket: )
                    - alias_expression:
                        keyword: AS
                        identifier: value
                    - keyword: WITH
                    - keyword: OFFSET
                    - keyword: AS
                    - identifier: ix
              end_bracket: )
