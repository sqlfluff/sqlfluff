# YML test files are auto-generated from SQL files and should not be edited by
# hand. To help enforce this, the "hash" field in the file must match a hash
# computed by SQLFluff when running the tests. Please run
# `python test/generate_parse_fixture_yml.py`  to generate them after adding or
# altering SQL files.
_hash: e4693f780a63b6d7b9022f539dabf166678fe8905aef76a9fc9acddd3f29f7e8
file:
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: my_mv
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            wildcard_expression:
              wildcard_identifier:
                star: '*'
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: my_table
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: OR
    - keyword: REPLACE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: my_mv
    - keyword: AS
    - select_statement:
        select_clause:
        - keyword: SELECT
        - select_clause_element:
            column_reference:
              naked_identifier: id
        - comma: ','
        - select_clause_element:
            column_reference:
              naked_identifier: name
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: my_table
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - keyword: IF
    - keyword: NOT
    - keyword: EXISTS
    - object_reference:
        naked_identifier: my_mv
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            wildcard_expression:
              wildcard_identifier:
                star: '*'
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: my_table
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: typed_mv
    - bracketed:
      - start_bracket: (
      - column_definition:
        - column_reference:
            naked_identifier: id
        - data_type:
            primitive_type:
              keyword: INT
        - column_properties_segment:
          - keyword: NOT
          - keyword: 'NULL'
        - column_properties_segment:
            keyword: COMMENT
            quoted_literal: "'Primary key'"
      - comma: ','
      - column_definition:
          column_reference:
            naked_identifier: name
          data_type:
            primitive_type:
              keyword: STRING
          column_properties_segment:
            keyword: COMMENT
            quoted_literal: "'Customer name'"
      - comma: ','
      - column_definition:
          column_reference:
            naked_identifier: amount
          data_type:
            primitive_type:
              keyword: DECIMAL
              bracketed_arguments:
                bracketed:
                - start_bracket: (
                - numeric_literal: '10'
                - comma: ','
                - numeric_literal: '2'
                - end_bracket: )
      - end_bracket: )
    - keyword: AS
    - select_statement:
        select_clause:
        - keyword: SELECT
        - select_clause_element:
            column_reference:
              naked_identifier: id
        - comma: ','
        - select_clause_element:
            column_reference:
              naked_identifier: name
        - comma: ','
        - select_clause_element:
            column_reference:
              naked_identifier: amount
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: orders
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: sales_mv
    - keyword: COMMENT
    - quoted_literal: "'Materialized view for sales analytics'"
    - keyword: AS
    - select_statement:
        select_clause:
        - keyword: SELECT
        - select_clause_element:
            column_reference:
              naked_identifier: region
        - comma: ','
        - select_clause_element:
            function:
              function_name:
                function_name_identifier: SUM
              function_contents:
                bracketed:
                  start_bracket: (
                  expression:
                    column_reference:
                      naked_identifier: amount
                  end_bracket: )
            alias_expression:
              alias_operator:
                keyword: as
              naked_identifier: total
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: sales
        groupby_clause:
        - keyword: GROUP
        - keyword: BY
        - column_reference:
            naked_identifier: region
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: partitioned_mv
    - keyword: PARTITIONED
    - keyword: BY
    - bracketed:
        start_bracket: (
        column_reference:
          naked_identifier: region
        end_bracket: )
    - keyword: AS
    - select_statement:
        select_clause:
        - keyword: SELECT
        - select_clause_element:
            column_reference:
              naked_identifier: region
        - comma: ','
        - select_clause_element:
            column_reference:
              naked_identifier: product
        - comma: ','
        - select_clause_element:
            function:
              function_name:
                function_name_identifier: SUM
              function_contents:
                bracketed:
                  start_bracket: (
                  expression:
                    column_reference:
                      naked_identifier: quantity
                  end_bracket: )
            alias_expression:
              alias_operator:
                keyword: as
              naked_identifier: total_qty
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: inventory
        groupby_clause:
        - keyword: GROUP
        - keyword: BY
        - column_reference:
            naked_identifier: region
        - comma: ','
        - column_reference:
            naked_identifier: product
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: clustered_mv
    - table_cluster_by_clause:
      - keyword: CLUSTER
      - keyword: BY
      - bracketed:
          start_bracket: (
          column_reference:
            naked_identifier: customer_id
          end_bracket: )
    - keyword: AS
    - select_statement:
        select_clause:
        - keyword: SELECT
        - select_clause_element:
            column_reference:
              naked_identifier: customer_id
        - comma: ','
        - select_clause_element:
            column_reference:
              naked_identifier: order_date
        - comma: ','
        - select_clause_element:
            column_reference:
              naked_identifier: total
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: orders
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: props_mv
    - keyword: TBLPROPERTIES
    - bracketed:
        start_bracket: (
        property_name_identifier:
          quoted_identifier: "'delta.autoOptimize.optimizeWrite'"
        comparison_operator:
          raw_comparison_operator: '='
        quoted_literal: "'true'"
        end_bracket: )
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            wildcard_expression:
              wildcard_identifier:
                star: '*'
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: large_table
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: collated_mv
    - keyword: DEFAULT
    - keyword: COLLATION
    - object_reference:
        naked_identifier: UTF8_BINARY
    - keyword: AS
    - select_statement:
        select_clause:
        - keyword: SELECT
        - select_clause_element:
            column_reference:
              naked_identifier: name
        - comma: ','
        - select_clause_element:
            column_reference:
              naked_identifier: address
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: customers
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: hourly_mv
    - keyword: SCHEDULE
    - keyword: EVERY
    - numeric_literal: '1'
    - keyword: HOUR
    - keyword: AS
    - select_statement:
        select_clause:
        - keyword: SELECT
        - select_clause_element:
            function:
              function_name:
                function_name_identifier: date_trunc
              function_contents:
                bracketed:
                - start_bracket: (
                - expression:
                    quoted_literal: "'hour'"
                - comma: ','
                - expression:
                    column_reference:
                      naked_identifier: event_time
                - end_bracket: )
            alias_expression:
              alias_operator:
                keyword: as
              naked_identifier: hour
        - comma: ','
        - select_clause_element:
            function:
              function_name:
                function_name_identifier: COUNT
              function_contents:
                bracketed:
                  start_bracket: (
                  star: '*'
                  end_bracket: )
            alias_expression:
              alias_operator:
                keyword: as
              naked_identifier: events
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: event_log
        groupby_clause:
        - keyword: GROUP
        - keyword: BY
        - numeric_literal: '1'
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: daily_mv
    - keyword: SCHEDULE
    - keyword: REFRESH
    - keyword: EVERY
    - numeric_literal: '1'
    - keyword: DAY
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            wildcard_expression:
              wildcard_identifier:
                star: '*'
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: daily_aggregates
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: weekly_mv
    - keyword: SCHEDULE
    - keyword: EVERY
    - numeric_literal: '2'
    - keyword: WEEKS
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            wildcard_expression:
              wildcard_identifier:
                star: '*'
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: weekly_report_data
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: cron_mv
    - keyword: SCHEDULE
    - keyword: CRON
    - quoted_literal: "'0 0 * * *'"
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            wildcard_expression:
              wildcard_identifier:
                star: '*'
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: nightly_batch
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: cron_tz_mv
    - keyword: SCHEDULE
    - keyword: CRON
    - quoted_literal: "'0 8 * * MON-FRI'"
    - keyword: AT
    - keyword: TIME
    - keyword: ZONE
    - quoted_literal: "'America/New_York'"
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            wildcard_expression:
              wildcard_identifier:
                star: '*'
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: business_hours_data
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: triggered_mv
    - keyword: TRIGGER
    - keyword: 'ON'
    - keyword: UPDATE
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            wildcard_expression:
              wildcard_identifier:
                star: '*'
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: streaming_source
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: throttled_mv
    - keyword: TRIGGER
    - keyword: 'ON'
    - keyword: UPDATE
    - keyword: AT
    - keyword: MOST
    - keyword: EVERY
    - interval_expression:
        keyword: INTERVAL
        interval_literal:
          numeric_literal: '5'
          date_part: MINUTES
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            wildcard_expression:
              wildcard_identifier:
                star: '*'
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: high_frequency_data
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: filtered_mv
    - keyword: WITH
    - keyword: ROW
    - keyword: FILTER
    - function_name:
        function_name_identifier: row_filter_func
    - keyword: 'ON'
    - bracketed:
      - start_bracket: (
      - column_reference:
          naked_identifier: department
      - comma: ','
      - column_reference:
          naked_identifier: salary
      - end_bracket: )
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            wildcard_expression:
              wildcard_identifier:
                star: '*'
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: employees
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: OR
    - keyword: REPLACE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: comprehensive_mv
    - bracketed:
      - start_bracket: (
      - column_definition:
          column_reference:
            naked_identifier: id
          data_type:
            primitive_type:
              keyword: INT
          column_properties_segment:
          - keyword: NOT
          - keyword: 'NULL'
      - comma: ','
      - column_definition:
          column_reference:
            naked_identifier: region
          data_type:
            primitive_type:
              keyword: STRING
      - comma: ','
      - column_definition:
          column_reference:
            naked_identifier: total
          data_type:
            primitive_type:
              keyword: DECIMAL
              bracketed_arguments:
                bracketed:
                - start_bracket: (
                - numeric_literal: '18'
                - comma: ','
                - numeric_literal: '2'
                - end_bracket: )
          column_properties_segment:
            keyword: COMMENT
            quoted_literal: "'Total amount'"
      - end_bracket: )
    - keyword: PARTITIONED
    - keyword: BY
    - bracketed:
        start_bracket: (
        column_reference:
          naked_identifier: region
        end_bracket: )
    - table_cluster_by_clause:
      - keyword: CLUSTER
      - keyword: BY
      - bracketed:
          start_bracket: (
          column_reference:
            naked_identifier: id
          end_bracket: )
    - keyword: COMMENT
    - quoted_literal: "'Comprehensive materialized view example'"
    - keyword: TBLPROPERTIES
    - bracketed:
        start_bracket: (
        property_name_identifier:
          quoted_identifier: "'quality'"
        comparison_operator:
          raw_comparison_operator: '='
        quoted_literal: "'gold'"
        end_bracket: )
    - keyword: SCHEDULE
    - keyword: EVERY
    - numeric_literal: '6'
    - keyword: HOURS
    - keyword: AS
    - select_statement:
        select_clause:
        - keyword: SELECT
        - select_clause_element:
            column_reference:
              naked_identifier: id
        - comma: ','
        - select_clause_element:
            column_reference:
              naked_identifier: region
        - comma: ','
        - select_clause_element:
            function:
              function_name:
                function_name_identifier: SUM
              function_contents:
                bracketed:
                  start_bracket: (
                  expression:
                    column_reference:
                      naked_identifier: amount
                  end_bracket: )
            alias_expression:
              alias_operator:
                keyword: as
              naked_identifier: total
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: transactions
        groupby_clause:
        - keyword: GROUP
        - keyword: BY
        - column_reference:
            naked_identifier: id
        - comma: ','
        - column_reference:
            naked_identifier: region
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: OR
    - keyword: REPLACE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: pk_mv
    - bracketed:
        start_bracket: (
        column_definition:
          column_reference:
            naked_identifier: col1
          data_type:
            primitive_type:
              keyword: BIGINT
          column_properties_segment:
            column_constraint_segment:
            - keyword: PRIMARY
            - keyword: KEY
        end_bracket: )
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            column_reference:
              naked_identifier: col1
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: tableA
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: OR
    - keyword: REFRESH
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: dlt_mv
    - keyword: AS
    - select_statement:
        select_clause:
          keyword: SELECT
          select_clause_element:
            wildcard_expression:
              wildcard_identifier:
                star: '*'
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                  naked_identifier: streaming_table
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: PRIVATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: dlt_private_mat_view
    - bracketed:
      - start_bracket: (
      - column_definition:
          column_reference:
            naked_identifier: a
          data_type:
            primitive_type:
              keyword: STRING
          column_properties_segment:
            keyword: COMMENT
            quoted_literal: "'a'"
      - comma: ','
      - column_definition:
          column_reference:
            naked_identifier: b
          data_type:
            primitive_type:
              keyword: TIMESTAMP
          column_properties_segment:
            keyword: COMMENT
            quoted_literal: "'b'"
      - end_bracket: )
    - keyword: COMMENT
    - quoted_literal: "'DLT private materialized view'"
    - keyword: AS
    - select_statement:
        select_clause:
        - keyword: SELECT
        - select_clause_element:
            column_reference:
              naked_identifier: a
        - comma: ','
        - select_clause_element:
            column_reference:
              naked_identifier: b
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                - naked_identifier: live
                - dot: .
                - naked_identifier: dlt_bronze
- statement_terminator: ;
- statement:
    create_materialized_view_statement:
    - keyword: CREATE
    - keyword: OR
    - keyword: REFRESH
    - keyword: PRIVATE
    - keyword: MATERIALIZED
    - keyword: VIEW
    - object_reference:
        naked_identifier: dlt_refresh_private_mat_view
    - bracketed:
      - start_bracket: (
      - column_definition:
          column_reference:
            naked_identifier: a
          data_type:
            primitive_type:
              keyword: STRING
          column_properties_segment:
            keyword: COMMENT
            quoted_literal: "'a'"
      - comma: ','
      - column_definition:
          column_reference:
            naked_identifier: b
          data_type:
            primitive_type:
              keyword: TIMESTAMP
          column_properties_segment:
            keyword: COMMENT
            quoted_literal: "'b'"
      - end_bracket: )
    - keyword: COMMENT
    - quoted_literal: "'DLT refreshed private materialized view'"
    - keyword: AS
    - select_statement:
        select_clause:
        - keyword: SELECT
        - select_clause_element:
            column_reference:
              naked_identifier: a
        - comma: ','
        - select_clause_element:
            column_reference:
              naked_identifier: b
        from_clause:
          keyword: FROM
          from_expression:
            from_expression_element:
              table_expression:
                table_reference:
                - naked_identifier: live
                - dot: .
                - naked_identifier: dlt_bronze
- statement_terminator: ;
