DEFINE FUNCTION DCM_PROJECT_DEV.ANALYTICS.CALCULATE_PROFIT_MARGIN(REVENUE number, COST number)
RETURNS NUMBER(10,2)
AS
$$
    CASE WHEN REVENUE = 0
THEN 0
ELSE ROUND(((REVENUE - COST) / REVENUE) * 100, 2)
    END
$$;
