-- Basic CREATE DATABASE
CREATE DATABASE MY_DATABASE;
CREATE DATABASE IF NOT EXISTS MY_DATABASE;
CREATE OR REPLACE DATABASE MY_DATABASE;
CREATE TRANSIENT DATABASE MY_DATABASE;
CREATE OR REPLACE TRANSIENT DATABASE IF NOT EXISTS MY_DATABASE;

-- CREATE OR ALTER DATABASE
CREATE OR ALTER DATABASE MY_DATABASE;
CREATE OR ALTER TRANSIENT DATABASE MY_DATABASE;
CREATE OR ALTER DATABASE MY_DATABASE
    DATA_RETENTION_TIME_IN_DAYS = 5
    DEFAULT_DDL_COLLATION = 'de';

-- Database properties
CREATE DATABASE MY_DATABASE DATA_RETENTION_TIME_IN_DAYS = 30;
CREATE DATABASE MY_DATABASE MAX_DATA_EXTENSION_TIME_IN_DAYS = 14;
CREATE DATABASE MY_DATABASE
    EXTERNAL_VOLUME = 'my_ext_volume'
    CATALOG = 'my_catalog_integration';
CREATE DATABASE MY_DATABASE REPLACE_INVALID_CHARACTERS = TRUE;
CREATE DATABASE MY_DATABASE DEFAULT_DDL_COLLATION = 'en-ci';
CREATE DATABASE MY_DATABASE STORAGE_SERIALIZATION_POLICY = OPTIMIZED;
CREATE DATABASE MY_DATABASE STORAGE_SERIALIZATION_POLICY = COMPATIBLE;
CREATE DATABASE MY_DATABASE COMMENT = 'My database';
CREATE DATABASE MY_DATABASE LOG_LEVEL = WARN;
CREATE DATABASE MY_DATABASE METRIC_LEVEL = ALL;
CREATE DATABASE MY_DATABASE TRACE_LEVEL = ON_EVENT;
CREATE DATABASE MY_DATABASE OBJECT_VISIBILITY = PRIVILEGED;
CREATE DATABASE MY_DATABASE ENABLE_DATA_COMPACTION = FALSE;
CREATE DATABASE MY_DATABASE WITH TAG (env = 'production', team = 'data');
CREATE DATABASE MY_DATABASE WITH CONTACT (STEWARD = my_steward, SUPPORT = my_support);

-- Catalog sync options
CREATE DATABASE MY_DATABASE
    CATALOG_SYNC = 'my_open_catalog_integration'
    CATALOG_SYNC_NAMESPACE_MODE = FLATTEN
    CATALOG_SYNC_NAMESPACE_FLATTEN_DELIMITER = '-';

-- CLONE variants
CREATE DATABASE MY_DATABASE CLONE source_db;
CREATE DATABASE MY_DATABASE CLONE source_db AT (TIMESTAMP => '2025-01-01 00:00:00'::TIMESTAMP_TZ);
CREATE DATABASE MY_DATABASE CLONE source_db BEFORE (STATEMENT => '01b71944-0001-b181-0000-0129032279f6');
CREATE DATABASE MY_DATABASE CLONE source_db AT (OFFSET => -3600);
CREATE DATABASE MY_DATABASE CLONE source_db IGNORE TABLES WITH INSUFFICIENT DATA RETENTION;
CREATE DATABASE MY_DATABASE CLONE source_db IGNORE HYBRID TABLES;
CREATE DATABASE MY_DATABASE CLONE source_db
    AT (TIMESTAMP => '2025-01-01 00:00:00'::TIMESTAMP_TZ)
    IGNORE TABLES WITH INSUFFICIENT DATA RETENTION
    IGNORE HYBRID TABLES;

-- CREATE DATABASE .. FROM
CREATE DATABASE MY_DATABASE FROM SHARE MY_ACCOUNT.MY_SHARE;
CREATE DATABASE MY_DATABASE FROM LISTING 'my_listing_global_name';
CREATE DATABASE MY_DATABASE FROM BACKUP SET my_backup_set IDENTIFIER 'abc123';

-- AS REPLICA OF
CREATE DATABASE MY_DATABASE AS REPLICA OF my_org.my_account.my_primary_db;
CREATE DATABASE MY_DATABASE
    AS REPLICA OF my_org.my_account.my_primary_db
    DATA_RETENTION_TIME_IN_DAYS = 10;

-- OBJECT_VISIBILITY with YAML spec
CREATE DATABASE MY_DATABASE OBJECT_VISIBILITY =
$$
organization_targets:
  - account: acme_engineering
  - account: acme_marketing
  - account: acme_sales
$$;

-- Full example
CREATE OR REPLACE DATABASE MY_DATABASE
    DATA_RETENTION_TIME_IN_DAYS = 30
    MAX_DATA_EXTENSION_TIME_IN_DAYS = 14
    EXTERNAL_VOLUME = 'my_ext_volume'
    REPLACE_INVALID_CHARACTERS = TRUE
    DEFAULT_DDL_COLLATION = 'en-ci'
    STORAGE_SERIALIZATION_POLICY = COMPATIBLE
    COMMENT = 'Full example database'
    LOG_LEVEL = INFO
    METRIC_LEVEL = NONE
    TRACE_LEVEL = OFF
    OBJECT_VISIBILITY = PRIVILEGED
    ENABLE_DATA_COMPACTION = TRUE
    WITH TAG (env = 'production', team = 'data')
    WITH CONTACT (STEWARD = my_steward, SUPPORT = my_support);
