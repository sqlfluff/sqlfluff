-- RENAME TO
ALTER DATABASE mydb RENAME TO mydb2;
ALTER DATABASE IF EXISTS mydb RENAME TO mydb2;

-- SWAP WITH
ALTER DATABASE mydb SWAP WITH yourdb;
ALTER DATABASE IF EXISTS mydb SWAP WITH yourdb;

-- SET database properties
ALTER DATABASE mydb SET DATA_RETENTION_TIME_IN_DAYS = 7;
ALTER DATABASE mydb SET MAX_DATA_EXTENSION_TIME_IN_DAYS = 14;
ALTER DATABASE mydb SET EXTERNAL_VOLUME = 'my_volume';
ALTER DATABASE mydb SET CATALOG = 'my_catalog';
ALTER DATABASE mydb SET REPLACE_INVALID_CHARACTERS = TRUE;
ALTER DATABASE mydb SET DEFAULT_DDL_COLLATION = 'en-ci';
ALTER DATABASE mydb SET DEFAULT_NOTEBOOK_COMPUTE_POOL_CPU = 'cpu_pool';
ALTER DATABASE mydb SET DEFAULT_NOTEBOOK_COMPUTE_POOL_GPU = 'gpu_pool';
ALTER DATABASE mydb SET DEFAULT_STREAMLIT_NOTEBOOK_WAREHOUSE = my_wh;
ALTER DATABASE mydb SET STORAGE_SERIALIZATION_POLICY = OPTIMIZED;
ALTER DATABASE mydb SET STORAGE_SERIALIZATION_POLICY = COMPATIBLE;
ALTER DATABASE mydb SET EVENT_TABLE = mydb.my_schema.my_event_table;
ALTER DATABASE mydb SET COMMENT = 'My database';
ALTER DATABASE mydb SET CLASSIFICATION_PROFILE = 'my_profile';
ALTER DATABASE mydb SET ENABLE_DATA_COMPACTION = FALSE;
ALTER DATABASE mydb SET
    DATA_RETENTION_TIME_IN_DAYS = 7
    MAX_DATA_EXTENSION_TIME_IN_DAYS = 14
    EXTERNAL_VOLUME = 'my_volume'
    CATALOG = 'my_catalog'
    REPLACE_INVALID_CHARACTERS = TRUE
    DEFAULT_DDL_COLLATION = 'en-ci';

-- SET object visibility
ALTER DATABASE mydb SET OBJECT_VISIBILITY = PRIVILEGED;
ALTER DATABASE mydb SET OBJECT_VISIBILITY =
$$
organization_targets:
  - account: acme_engineering
  - account: acme_marketing
$$;

-- SET logging, metrics & tracing
ALTER DATABASE mydb SET LOG_LEVEL = WARN;
ALTER DATABASE mydb SET METRIC_LEVEL = ALL;
ALTER DATABASE mydb SET TRACE_LEVEL = ON_EVENT;

-- SET catalog sync & replication
ALTER DATABASE mydb SET CATALOG_SYNC = 'my_open_catalog_integration';
ALTER DATABASE mydb SET REPLICABLE_WITH_FAILOVER_GROUPS = 'YES';
ALTER DATABASE mydb SET BASE_LOCATION_PREFIX = 'prefix/path';
ALTER DATABASE mydb SET
    CATALOG_SYNC = 'my_open_catalog_integration'
    REPLICABLE_WITH_FAILOVER_GROUPS = 'YES'
    BASE_LOCATION_PREFIX = 'prefix/path';

-- SET contact
ALTER DATABASE mydb SET CONTACT STEWARD = admin_user, SUPPORT = support_user;

-- SET data quality monitoring
ALTER DATABASE mydb SET DATA_QUALITY_MONITORING_SETTINGS =
$$
notification:
  enabled: true
  integrations:
    - my_notification_integration
  metadata_included: true
$$;

-- SET TAG
ALTER DATABASE mydb SET TAG environment = 'test', billed_to = 'sales';

-- UNSET TAG
ALTER DATABASE mydb UNSET TAG environment, billed_to;

-- UNSET database properties
ALTER DATABASE mydb UNSET DATA_RETENTION_TIME_IN_DAYS;
ALTER DATABASE mydb UNSET MAX_DATA_EXTENSION_TIME_IN_DAYS;
ALTER DATABASE mydb UNSET EXTERNAL_VOLUME;
ALTER DATABASE mydb UNSET CATALOG;
ALTER DATABASE mydb UNSET DEFAULT_DDL_COLLATION;
ALTER DATABASE mydb UNSET DEFAULT_NOTEBOOK_COMPUTE_POOL_CPU, DEFAULT_NOTEBOOK_COMPUTE_POOL_GPU;
ALTER DATABASE mydb UNSET DEFAULT_STREAMLIT_NOTEBOOK_WAREHOUSE;
ALTER DATABASE mydb UNSET OBJECT_VISIBILITY;
ALTER DATABASE mydb UNSET STORAGE_SERIALIZATION_POLICY;
ALTER DATABASE mydb UNSET EVENT_TABLE = mydb.my_schema.my_event_table;
ALTER DATABASE mydb UNSET COMMENT;
ALTER DATABASE mydb UNSET CATALOG_SYNC;
ALTER DATABASE mydb UNSET REPLICABLE_WITH_FAILOVER_GROUPS;
ALTER DATABASE mydb UNSET BASE_LOCATION_PREFIX;
ALTER DATABASE mydb UNSET CLASSIFICATION_PROFILE;
ALTER DATABASE mydb UNSET CONTACT STEWARD;
ALTER DATABASE mydb UNSET ENABLE_DATA_COMPACTION;

-- Full SET example
ALTER DATABASE IF EXISTS mydb SET
    DATA_RETENTION_TIME_IN_DAYS = 30
    MAX_DATA_EXTENSION_TIME_IN_DAYS = 14
    EXTERNAL_VOLUME = 'my_volume'
    CATALOG = 'my_catalog'
    REPLACE_INVALID_CHARACTERS = TRUE
    DEFAULT_DDL_COLLATION = 'en-ci'
    DEFAULT_NOTEBOOK_COMPUTE_POOL_CPU = 'cpu_pool'
    DEFAULT_NOTEBOOK_COMPUTE_POOL_GPU = 'gpu_pool'
    DEFAULT_STREAMLIT_NOTEBOOK_WAREHOUSE = my_wh
    OBJECT_VISIBILITY = PRIVILEGED
    STORAGE_SERIALIZATION_POLICY = OPTIMIZED
    EVENT_TABLE = my_schema.my_event_table
    COMMENT = 'Full example database'
    CATALOG_SYNC = 'my_open_catalog_integration'
    REPLICABLE_WITH_FAILOVER_GROUPS = 'YES'
    BASE_LOCATION_PREFIX = 'prefix/path'
    CLASSIFICATION_PROFILE = 'my_profile'
    ENABLE_DATA_COMPACTION = TRUE;

-- Full UNSET example
ALTER DATABASE IF EXISTS mydb UNSET
    DATA_RETENTION_TIME_IN_DAYS,
    MAX_DATA_EXTENSION_TIME_IN_DAYS,
    EXTERNAL_VOLUME,
    CATALOG,
    DEFAULT_DDL_COLLATION,
    DEFAULT_NOTEBOOK_COMPUTE_POOL_CPU,
    DEFAULT_NOTEBOOK_COMPUTE_POOL_GPU,
    OBJECT_VISIBILITY,
    STORAGE_SERIALIZATION_POLICY,
    COMMENT,
    CATALOG_SYNC,
    REPLICABLE_WITH_FAILOVER_GROUPS,
    BASE_LOCATION_PREFIX,
    DEFAULT_STREAMLIT_NOTEBOOK_WAREHOUSE,
    CLASSIFICATION_PROFILE,
    ENABLE_DATA_COMPACTION;
