-- Basic data metric function
CREATE DATA METRIC FUNCTION my_dmf
  (ARG_T TABLE(col1 NUMBER))
  RETURNS NUMBER
  AS 'SELECT COUNT(*) FROM ARG_T WHERE col1 IS NULL';

-- Secure data metric function
CREATE OR REPLACE SECURE DATA METRIC FUNCTION IF NOT EXISTS my_dmf
  (ARG_T TABLE(col1 VARCHAR, col2 NUMBER))
  RETURNS NUMBER NOT NULL
  LANGUAGE SQL
  COMMENT = 'null check metric'
  AS 'SELECT COUNT(*) FROM ARG_T WHERE col1 IS NULL OR col2 IS NULL';
