GRANT OWNERSHIP ON SCHEMA MY_DATABASE.MY_SCHEMA TO ROLE MY_ROLE;

GRANT ROLE MY_ROLE TO ROLE MY_OTHER_ROLE;

GRANT USE_ANY_ROLE ON INTEGRATION EXTERNAL_OAUTH_1 TO ROLE1;

GRANT OWNERSHIP ON TABLE MYSCHEMA.MYTABLE TO ROLE ANALYST;

GRANT OWNERSHIP ON ALL TABLES IN SCHEMA PUBLIC TO ROLE ANALYST;

GRANT OWNERSHIP ON ALL TABLES IN SCHEMA MYDB.PUBLIC TO ROLE ANALYST;

GRANT OWNERSHIP ON ALL TABLES IN SCHEMA MYDB.PUBLIC TO ROLE ANALYST COPY CURRENT GRANTS;

GRANT ROLE ROLENAME TO ROLE IDENTIFIER($THIS_ROLE);

GRANT OWNERSHIP ON ROLE TEST_ROLE TO ROLE DIFFERENT_ROLE;

GRANT ALL ON ALL MATERIALIZED VIEWS IN DATABASE MY_DB TO ROLE ANALYST;
GRANT ALL ON ALL FILE FORMATS IN DATABASE MY_DB TO ROLE ANALYST;
GRANT CREATE TEMPORARY TABLE ON SCHEMA MY_DB.MY_SCHEMA TO ROLE ANALYST;
GRANT ALL ON FUTURE PIPES IN DATABASE MY_DB TO ROLE ANALYST;
GRANT ALL ON FUTURE FILE FORMATS IN DATABASE MY_DB TO ROLE ANALYST;
GRANT ALL ON FUTURE MATERIALIZED VIEWS IN DATABASE MY_DB TO ROLE ANALYST;
GRANT ALL ON FUTURE PIPES IN DATABASE MY_DB TO ROLE ANALYST;
GRANT USAGE ON ALL SEQUENCES IN DATABASE MY_DB TO ROLE ANALYST;
GRANT ALL ON ALL MATERIALIZED VIEWS IN DATABASE MY_DB TO ROLE ANALYST;
GRANT ALL ON ALL SEQUENCES IN DATABASE MY_DB TO ROLE ANALYST;
GRANT ALL ON ALL FUNCTIONS IN DATABASE MY_DB TO ROLE ANALYST;
GRANT ALL ON ALL FILE FORMATS IN DATABASE MY_DB TO ROLE ANALYST;
GRANT ALL ON ALL STAGES IN DATABASE MY_DB TO ROLE ANALYST;
GRANT SELECT ON ALL VIEWS IN DATABASE MY_DB TO ROLE ANALYST;

REVOKE ROLE ANALYST FROM ROLE SYSADMIN;

REVOKE SELECT, INSERT ON FUTURE TABLES IN SCHEMA MYDB.MYSCHEMA FROM ROLE ROLE1;

REVOKE ALL PRIVILEGES ON FUNCTION add5(number) FROM ROLE ANALYST;

REVOKE GRANT OPTION FOR OPERATE ON WAREHOUSE REPORT_WH FROM ROLE ANALYST;

REVOKE SELECT ON ALL TABLES IN SCHEMA MYDB.MYSCHEMA FROM ROLE ANALYST;

REVOKE OPERATE ON WAREHOUSE REPORT_WH FROM ROLE ANALYST;

REVOKE REFERENCE_USAGE ON DATABASE DATABASE2 FROM SHARE SHARE1;

REVOKE OWNERSHIP ON ROLE TEST_ROLE FROM ROLE DIFFERENT_ROLE;

GRANT IMPORTED PRIVILEGES ON SCHEMA MYDB.MYSCHEMA TO APPLICATION MY_APP;

GRANT OPERATE ON WAREHOUSE REPORT_WH TO ROLE ANALYST;
GRANT OPERATE ON WAREHOUSE REPORT_WH TO ROLE ANALYST WITH GRANT OPTION;
GRANT OPERATE ON FUTURE DYNAMIC TABLES IN SCHEMA MYDB.MYSCHEMA TO ROLE ANALYST;
GRANT OPERATE ON ALL DYNAMIC TABLES IN SCHEMA MYDB.MYSCHEMA TO ROLE ANALYST;
GRANT SELECT ON ALL TABLES IN SCHEMA MYDB.MYSCHEMA TO ROLE ANALYST;
GRANT ALL PRIVILEGES ON FUNCTION mydb.myschema.add5(number) TO ROLE ANALYST;
GRANT ALL PRIVILEGES ON FUNCTION mydb.myschema.add5(string) TO ROLE ANALYST;
GRANT USAGE ON PROCEDURE mydb.myschema.myprocedure(number) TO ROLE ANALYST;
GRANT CREATE MATERIALIZED VIEW ON SCHEMA MYDB.MYSCHEMA TO ROLE MYROLE;
GRANT SELECT, INSERT ON FUTURE TABLES IN SCHEMA MYDB.MYSCHEMA TO ROLE ROLE1;
GRANT USAGE ON FUTURE SCHEMAS IN DATABASE MYDB TO ROLE ROLE1;

GRANT USAGE ON DATABASE DATABASE1 TO SHARE SHARE1;
GRANT USAGE ON SCHEMA DATABASE1.SCHEMA1 TO SHARE SHARE1;
GRANT REFERENCE_USAGE ON DATABASE DATABASE2 TO SHARE SHARE1;
GRANT SELECT ON VIEW VIEW2 TO SHARE SHARE1;
GRANT USAGE ON DATABASE MYDB TO SHARE SHARE1;
GRANT USAGE ON SCHEMA MYDB.PUBLIC TO SHARE SHARE1;
GRANT USAGE ON FUNCTION MYDB.SHARED_SCHEMA.FUNCTION1 TO SHARE SHARE1;
GRANT SELECT ON ALL TABLES IN SCHEMA MYDB.PUBLIC TO SHARE SHARE1;
GRANT USAGE ON SCHEMA MYDB.SHARED_SCHEMA TO SHARE SHARE1;
GRANT SELECT ON VIEW MYDB.SHARED_SCHEMA.VIEW1 TO SHARE SHARE1;
GRANT SELECT ON VIEW MYDB.SHARED_SCHEMA.VIEW3 TO SHARE SHARE1;

GRANT ROLE ANALYST TO USER USER1;

REVOKE ALL PRIVILEGES ON PROCEDURE clean_schema(string) FROM ROLE ANALYST;
REVOKE ALL PRIVILEGES ON FUNCTION add5(string) FROM ROLE ANALYST;

REVOKE SELECT ON VIEW MYDB.SHARED_SCHEMA.VIEW1 FROM SHARE SHARE1;
REVOKE USAGE ON SCHEMA MYDB.SHARED_SCHEMA FROM SHARE SHARE1;
REVOKE SELECT ON ALL TABLES IN SCHEMA MYDB.PUBLIC FROM SHARE SHARE1;
REVOKE USAGE ON SCHEMA MYDB.PUBLIC FROM SHARE SHARE1;
REVOKE USAGE ON DATABASE MYDB FROM SHARE SHARE1;

GRANT APPLY MASKING POLICY ON ACCOUNT TO ROLE MY_ROLE;
GRANT APPLY ROW ACCESS POLICY ON ACCOUNT TO ROLE MY_ROLE;
GRANT APPLY SESSION POLICY ON ACCOUNT TO ROLE MY_ROLE;
GRANT APPLY TAG ON ACCOUNT TO ROLE MY_ROLE;
GRANT ATTACH POLICY ON ACCOUNT TO ROLE MY_ROLE;
GRANT EXECUTE ALERT ON ACCOUNT TO ROLE MY_ROLE;
GRANT EXECUTE TASK ON ACCOUNT TO ROLE MY_ROLE;
GRANT EXECUTE MANAGED TASK ON ACCOUNT TO ROLE MY_ROLE;
GRANT IMPORT SHARE ON ACCOUNT TO ROLE MY_ROLE;
GRANT MANAGE GRANTS ON ACCOUNT TO ROLE MY_ROLE;
GRANT MONITOR EXECUTION ON ACCOUNT TO ROLE MY_ROLE;
GRANT MONITOR USAGE ON ACCOUNT TO ROLE MY_ROLE;
GRANT MONITOR ON USER SOME_USER TO ROLE MY_ROLE;
REVOKE MONITOR ON USER SOME_USER FROM ROLE MY_ROLE;
GRANT OVERRIDE SHARE RESTRICTIONS ON ACCOUNT TO ROLE MY_ROLE;
GRANT CREATE ACCOUNT ON ACCOUNT TO ROLE MY_ROLE;
GRANT CREATE SHARE ON ACCOUNT TO ROLE MY_ROLE;
GRANT CREATE NETWORK POLICY ON ACCOUNT TO ROLE MY_ROLE;
GRANT CREATE TAG ON SCHEMA MY_SCHEMA TO ROLE MY_ROLE;
GRANT CREATE DATA EXCHANGE LISTING ON ACCOUNT TO ROLE MY_ROLE;
GRANT CREATE CORTEX SEARCH SERVICE ON SCHEMA MY_SCHEMA TO ROLE MY_ROLE;
GRANT USAGE ON CORTEX SEARCH SERVICE MY_SERVICE TO ROLE MY_ROLE;
GRANT MANAGE ACCOUNT SUPPORT CASES ON ACCOUNT TO ROLE MY_ROLE;
GRANT MANAGE ORGANIZATION SUPPORT CASES ON ACCOUNT TO ROLE MY_ROLE;
GRANT MANAGE USER SUPPORT CASES ON ACCOUNT TO ROLE MY_ROLE;

GRANT ADD SEARCH OPTIMIZATION ON SCHEMA MY_SCHEMA TO ROLE MY_ROLE;

GRANT DATABASE ROLE DBNAME.ROLENAME TO ROLE PUBLIC;
GRANT DATABASE ROLE DBROLENAME TO ROLE PUBLIC;
REVOKE DATABASE ROLE DBNAME.ROLENAME FROM ROLE PUBLIC;
REVOKE DATABASE ROLE DBROLENAME FROM ROLE PUBLIC;
GRANT SELECT ON TABLE DBNAME.SCHEMANAME.TABLENAME TO DATABASE ROLE DBNAME.ROLENAME;
GRANT SELECT ON TABLE DBNAME.SCHEMANAME.TABLENAME TO DATABASE ROLE DBROLENAME;
REVOKE SELECT ON TABLE DBNAME.SCHEMANAME.TABLENAME FROM DATABASE ROLE DBNAME.ROLENAME;
REVOKE SELECT ON TABLE DBNAME.SCHEMANAME.TABLENAME FROM DATABASE ROLE DBROLENAME;

GRANT APPLICATION ROLE DBROLENAME TO ROLE PUBLIC;

GRANT CREATE NOTEBOOK ON SCHEMA MY_DB.MYSCHEMA TO ROLE MYROLE;
GRANT OWNERSHIP ON NOTEBOOK MY_DB.MYSCHEMA.MYNOTEBOOK TO ROLE MYROLE;
GRANT USAGE ON NOTEBOOK MY_DB.MYSCHEMA.MYNOTEBOOK TO ROLE MYROLE;
REVOKE CREATE NOTEBOOK ON SCHEMA MY_DB.MYSCHEMA FROM ROLE MYROLE;
REVOKE USAGE ON NOTEBOOK MY_DB.MYSCHEMA.MYNOTEBOOK FROM ROLE MYROLE;

GRANT CREATE MODEL ON SCHEMA MY_DB.MYSCHEMA TO ROLE MYROLE;
GRANT OWNERSHIP ON MODEL MY_DB.MYSCHEMA.MYMODEL TO ROLE MYROLE;
GRANT USAGE ON MODEL MY_DB.MYSCHEMA.MYMODEL TO ROLE MYROLE;
REVOKE CREATE MODEL ON SCHEMA MY_DB.MYSCHEMA FROM ROLE MYROLE;
REVOKE USAGE ON MODEL MY_DB.MYSCHEMA.MYMODEL FROM ROLE MYROLE;

GRANT USAGE ON EXTERNAL VOLUME ext_vol TO ROLE MY_ROLE;
REVOKE USAGE ON EXTERNAL VOLUME ext_vol FROM ROLE MY_ROLE;

GRANT CREATE DYNAMIC TABLE ON SCHEMA foo TO ROLE bar;
REVOKE CREATE DYNAMIC TABLE ON SCHEMA foo FROM ROLE bar;

GRANT CREATE WORKSPACE ON SCHEMA foo TO ROLE bar;
REVOKE CREATE WORKSPACE ON SCHEMA foo FROM ROLE bar;
GRANT WRITE ON WORKSPACE my_workspace TO ROLE bar;
REVOKE WRITE ON WORKSPACE my_workspace FROM ROLE bar;
